<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>λ³΄μ• QR μ½”λ“ μƒμ„±κΈ° (μµμ… μ•”νΈν™”)</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<main>
  <h2>QR μ½”λ“ μƒμ„±</h2>
  <label for="inputText">λ‚΄μ© μ…λ ¥ (ν•„μ)</label>
  <textarea id="inputText" rows="4" placeholder="λ‚΄μ©μ„ μ…λ ¥ν•μ„Έμ”"></textarea>

  <div class="flex-row">
    <div class="form-section">
      <label for="inputAuthor" style="margin: 0;">μ‘μ„±μ (μ„ νƒ)</label>
      <input type="text" id="inputAuthor" placeholder="μ‘μ„±μ" />

      <label>λ§λ£ μ‹κ°„</label>
      <select id="expireUnit" onchange="handleExpireUnitChange()">
        <option value="none">μ—†μ</option>
        <option value="minute">λ¶„</option>
        <option value="hour">μ‹κ°„</option>
        <option value="day">μΌ</option>
      </select>
      <input type="number" id="expireValue" placeholder="μ‹κ°„ μ…λ ¥ (μ«μ)" disabled />

      <label for="inputPassword">λΉ„λ°€λ²νΈ (μ„ νƒ)</label>
      <input type="password" id="inputPassword" placeholder="λΉ„λ°€λ²νΈκ°€ μ—†μΌλ©΄ μ•”νΈν™”λμ§€ μ•μµλ‹λ‹¤." />

      <button id="generateBtn" onclick="generateSecureQR()">
        <span id="generateBtnText">β… QR μƒμ„±ν•κΈ°</span>
        <div id="generateSpinner" class="spinner"></div>
      </button>

      <button onclick="downloadQR()">π’Ύ QR λ‹¤μ΄λ΅λ“</button>
    </div>

    <div class="qr-preview">
      <div id="qrcode"></div>
    </div>
  </div>

  <h2>QR μ΄λ―Έμ§€ ν•΄μ„</h2>
  <div class="flex-row">
    <div class="form-section">
      <input type="file" style="margin: 0;" accept="image/*" onchange="handleFile(event)" />
      <input type="password" id="decryptPassword" placeholder="λΉ„λ°€λ²νΈ(μ—†μΌλ©΄ ν‰λ¬Έ ν•΄μ„)" style="margin-top:1rem;" />

      <button id="decryptBtn" onclick="tryDecrypt()">
        <span id="decryptBtnText">π” ν•΄μ„ μ‹λ„</span>
        <div id="decryptSpinner" class="spinner"></div>
      </button>

      <button onclick="copyDecryptedText()">π“‹ λ‚΄μ© λ³µμ‚¬</button>
      <div id="decodeResult" class="result">νμΌμ„ μ—…λ΅λ“ν•΄μ£Όμ„Έμ”</div>
      <div id="copyMsg" class="message"></div>
    </div>

    <div class="qr-preview">
      <img id="previewImage" style="display: none;" />
    </div>
  </div>

  <div id="finalOutput"></div>
  <canvas id="canvas" style="display:none;"></canvas>
</main>
<script src="script.js"></script>
</body>
</html>
